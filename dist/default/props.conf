[default]


[watchguard:endpoint:log]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
TZ = UTC
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
TRANSFORMS-sourcetype_rename = wg_ep_sourcetype,wg_ep_date,wg_ep_alert

[watchguard:endpoint:modifype]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "modified"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_modify_time = coalesce(devTime, Date, _time)
EVAL-new_file_name = mvindex(split(mvindex(split(Params, "\\"),-1), "/"),-1)
FIELDALIAS-wg_ep_modifype_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_modifype_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_modifype_file_path = ChildPath as file_path
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:renamepe]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "modified"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_modify_time = coalesce(devTime, Date, _time)
EVAL-new_file_name = mvindex(split(mvindex(split(Params, "\\"),-1), "/"),-1)
FIELDALIAS-wg_ep_renamepe_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_renamepe_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_renamepe_file_path = ChildPath as file_path
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:createpe]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "created"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_create_time = coalesce(devTime, Date, _time)
FIELDALIAS-wg_ep_createpe_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_createpe_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_createpe_file_path = ChildPath as file_path
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:deletepe]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "deleted"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_modify_time = coalesce(devTime, Date, _time)
FIELDALIAS-wg_ep_deletepe_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_deletepe_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_deletepe_file_path = ChildPath as file_path
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:loginoutops]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = if(ErrorCode == "0", "success", "failure")
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-domain = if(isnull(domain) and like(User,"%\\%"),mvindex(split(User,"\\"),0),domain)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-src = coalesce(RemoteMachineName, RemoteIP, identHostName, identSrc)
EVAL-app = if(SessionType == "10", "win:remote", null())
LOOKUP-wg_ep_auth_error_code_lookup = wg_ep_auth_error_lookup ErrorCode OUTPUT reason
LOOKUP-wg_ep_auth_session_type_lookup = wg_ep_auth_session_type_lookup SessionType OUTPUT session_description
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:createdir]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "created"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_create_time = coalesce(devTime, Date, _time)
FIELDALIAS-wg_ep_createpe_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_createpe_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_createpe_file_path = ChildPath as file_path
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:monitoredopen]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:systemops]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-service_name = if(Type=="10", ObjectName, null())
EVAL-service = if(Type=="10", ObjectName, null())
EVAL-service_path = if(Type=="10", rtrim(mvindex(split(mvindex(split(CommandLine, " -"),0), " /"),0),"\""), null())
EVAL-service_exec = if(Type=="10", rtrim(mvindex(split(mvindex(split(mvindex(split(CommandLine, " -"),0), " /"),0),"\\"),-1),"\""), null())
LOOKUP-wg_ep_systemops_op_type_lookup = wg_ep_systemops_op_type_lookup Type OUTPUT operation, operation_description
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:createremotethread]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-action = lower(Action)+"ed"
EVAL-parent_process = lower(ParentPath)
EVAL-parent_process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-parent_process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_exec = lower(mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1))
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-signature = if(isnotnull(ChildMWName),ChildMWName,null())
FIELDALIAS-wg_ep_createremotethread_parent_path = ParentPath AS parent_process_path
FIELDALIAS-wg_ep_createremotethread_child_path = ChildPath AS process_path
FIELDALIAS-wg_ep_createremotethread_child_hash = ChildHash AS process_hash
FIELDALIAS-wg_ep_createremotethread_child_pid = ChildPid AS process_id
FIELDALIAS-wg_ep_createremotethread_parent_pid = ParentPid AS parent_process_id
FIELDALIAS-wg_ep_createremotethread_params = Params AS process
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:loadlib]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-action = "read"
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = lower(mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1))
EVAL-signature = if(isnotnull(ChildMWName),ChildMWName,null())
EVAL-severity = if(ChildCat=="Malware", "high", if(ChildCat=="PUP", "low", "informational"))
FIELDALIAS-wg_ep_loadlib_pid = ParentPid as process_id
FIELDALIAS-wg_ep_loadlib_process_hash = ParentHash as process_hash
FIELDALIAS-wg_ep_loadlib_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_loadlib_file_path = ChildPath as file_path
FIELDALIAS-wg_ep_loadlib_loaded_file = ChildPath as loaded_file
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:dnsops]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-query = split(replace(rtrim(trim(DomainList,"{"),"}"),",\d+",""),"#")
EVAL-process = lower(ProcessPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ProcessPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ProcessPath, "\\"),-1), "/"),-1))
EVAL-src = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-src_ip = coalesce(identSrc, MachineIP)
EVAL-src_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-query_type = "Query"
FIELDALIAS-wg_ep_dnsops_pid = ProcessPid as process_id
FIELDALIAS-wg_ep_dnsops_query_count = QueriedDomainCount as query_count
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:processnetbytes]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "allowed"
EVAL-src = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-src_ip = coalesce(identSrc, MachineIP)
EVAL-src_host = coalesce(identHostName, MachineName)
EVAL-process = lower(Path)
EVAL-process_path = lower(Path)
EVAL-process_exec = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
FIELDALIAS-wg_ep_processnetbytes_pid = PID as process_id
FIELDALIAS-wg_ep_processnetbytes_bytes_in = BytesReceived as bytes_in
FIELDALIAS-wg_ep_processnetbytes_bytes_out = BytesSent as bytes_out
EVAL-bytes = (bytes_in + bytes_out)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:createcmp]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "created"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_create_time = coalesce(devTime, Date, _time)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
FIELDALIAS-wg_ep_createcmp_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_createcmp_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_createcmp_file_path = ChildPath as file_path
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:svccontrol]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:block]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-action = "blocked"
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1)
FIELDALIAS-wg_ep_block_hash = Hash AS file_hash
FIELDALIAS-wg_ep_block_path = Path as file_path
LOOKUP-wg_ep_detection_tech_info = wg_ep_detection_tech_lookup WinningTech OUTPUT action_reason
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:deviceops]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:exec]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-action = lower(Action)+"ed"
EVAL-parent_process = lower(ParentPath)
EVAL-parent_process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-parent_process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_exec = lower(mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1))
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-signature = if(isnotnull(ChildMWName),ChildMWName,null())
FIELDALIAS-wg_ep_exec_process_hash = ParentHash AS process_hash
FIELDALIAS-wg_ep_exec_parent_path = ParentPath AS parent_process_path
FIELDALIAS-wg_ep_exec_child_path = ChildPath AS process_path
FIELDALIAS-wg_ep_exec_child_pid = ChildPid AS process_id
FIELDALIAS-wg_ep_exec_parent_pid = ParentPid AS parent_process_id
FIELDALIAS-wg_ep_exec_params = Params AS process
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:socket]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-app = mvindex(split(Path, "\\\\"),-1)
EVAL-dvc = coalesce(identHostName, MachineName)
EVAL-direction = if(Direction=="Up", "outbound", "inbound")
EVAL-process = lower(Path)
EVAL-process_exec = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-dest = if(Direction=="Up", coalesce(Hostname, IP), coalesce(identHostName, MachineName, LocalIp, MachineIP))
EVAL-dest_host = if(Direction=="Up", Hostname, coalesce(identHostName, MachineName))
EVAL-dest_ip = if(Direction=="Up", IP, coalesce(LocalIp, MachineIP))
EVAL-dest_port = if(Direction=="Up", Port, LocalPort)
EVAL-src = if(Direction=="Up", coalesce(identHostName, MachineName, LocalIp, MachineIP), coalesce(Hostname, IP))
EVAL-src_host = if(Direction=="Up", coalesce(identHostName, MachineName), Hostname)
EVAL-src_ip = if(Direction=="Up", coalesce(LocalIp, MachineIP), IP)
EVAL-src_port = if(Direction=="Up", if(LocalPort > 0, LocalPort, null), null)
EVAL-transport = substr(lower(Protocol),0, 3)
EVAL-protocol = "ip"
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
FIELDALIAS-wg_ep_socket_file_path = Path as file_path
FIELDALIAS-wg_ep_socket_child_pid = Pid AS process_id
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:criticalsoft]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-category = "critical software"
EVAL-dvc = identHostName
EVAL-severity = informational
EVAL-signature = FileName + " " + ProductVersion
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
FIELDALIAS-wg_ep_machine_ip = identSrc AS dest_ip
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:opencmp]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-action = "read"
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_access_time = coalesce(devTime, Date, _time)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
FIELDALIAS-wg_ep_opencmp_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_opencmp_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_opencmp_file_path = ChildPath as file_path
FIELDALIAS-wg_ep_parent_path = ParentPath AS parent_process_path
FIELDALIAS-wg_ep_parent_pid = ParentPid AS parent_process_id
EVAL-dest_ip = coalesce(identSrc, MachineIP)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:scriptcreation]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-action = "created"
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-file_name = mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1)
EVAL-file_access_time = coalesce(devTime, Date, _time)
EVAL-file_create_time = coalesce(devTime, Date, _time)
EVAL-file_modify_time = coalesce(devTime, Date, _time)
EVAL-process = lower(ParentPath)
EVAL-process_path = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
FIELDALIAS-wg_ep_scriptcreation_process_id = ParentPid as process_id
FIELDALIAS-wg_ep_scriptcreation_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_scriptcreation_file_path = ChildPath as file_path
FIELDALIAS-wg_ep_scriptcreation_parent_path = ParentPath AS parent_process_path
FIELDALIAS-wg_ep_scriptcreation_parent_pid = ParentPid AS parent_process_id
EVAL-dest_ip = coalesce(identSrc, MachineIP)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:hostfiles]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-action = "modified"
EVAL-change_type = "filesystem"
EVAL-dvc = identHostName
EVAL-file_name = "hosts"
EVAL-file_path = "C:\Windows\System32\drivers\etc\hosts"
EVAL-object = "hostsfile"
EVAL-object_category = "file"
EVAL-object_path = "C:\Windows\System32\drivers\etc\hosts"
EVAL-src = identHostName
EVAL-src_ip = identSrc
EVAL-src_user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-status = "success"
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
FIELDALIAS-wg_ep_machine_ip = identSrc AS dest_ip
FIELDALIAS-wg_ep_hostfiles_dest_host = identHostName as dest_host
FIELDALIAS-wg_ep_process_guid = Path AS process_guid
FIELDALIAS-wg_ep_command = Path AS command
FIELDALIAS-wg_ep_result = Cat AS result
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:registrym]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "modified"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(Path)
EVAL-process_path = lower(Path)
EVAL-process_exec = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-registry_key_name = mvindex(split(mvindex(split(RegKey, "?"),0), "\\"),-1)
EVAL-registry_path = mvindex(split(RegKey, "?"),0)
EVAL-registry_value_name = mvindex(split(mvindex(split(RegKey, "?"),-1), "\="),0)
EVAL-registry_value_data = if(isnull(TargetPath),mvjoin(mvindex(split(mvindex(split(RegKey, "?"),-1), "\="),1,-1),"="),TargetPath)
FIELDALIAS-wg_ep_registrym_hash = Hash AS process_hash
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:registryc]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = "created"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-process = lower(Path)
EVAL-process_path = lower(Path)
EVAL-process_exec = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(Path, "\\"),-1), "/"),-1))
EVAL-registry_key_name = mvindex(split(mvindex(split(RegKey, "?"),0), "\\"),-1)
EVAL-registry_path = mvindex(split(RegKey, "?"),0)
EVAL-registry_value_name = mvindex(split(mvindex(split(RegKey, "?"),-1), "\="),0)
EVAL-registry_value_data = if(isnull(TargetPath),mvjoin(mvindex(split(mvindex(split(RegKey, "?"),-1), "\="),1,-1),"="),TargetPath)
FIELDALIAS-wg_ep_registryc_hash = Hash AS process_hash
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:monitoredregistry]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-action = case(RegAction == "ModifyValue", "modified", RegAction == "CreateKey", "created", RegAction == "CreateValue", "created", 1==1, "unknown")
EVAL-change_type = "registry"
EVAL-dvc = coalesce(identHostName, MachineName)
EVAL-dvc_ip = coalesce(identSrc, MachineIP)
EVAL-object = ValueData
EVAL-object_category = "registry"
EVAL-object_path = Key
EVAL-registry_key_name = mvindex(split(Key, "\\"),-1)
EVAL-registry_value_name = Value
EVAL-result = lower(RegAction)
EVAL-src = coalesce(identHostName, identSrc, MachineName, MachineIP)
EVAL-src_ip = coalesce(identSrc, MachineIP)
EVAL-status = "sucess"
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
FIELDALIAS-wg_ep_registry_path = Key AS registry_path
FIELDALIAS-wg_ep_parent_pid = ParentPid AS process_id
FIELDALIAS-wg_ep_registry_value_data = ValueData AS registry_value_data
FIELDALIAS-wg_ep_registry_value_text = ValueData AS registry_value_text
FIELDALIAS-wg_ep_process_path = ParentPath AS command
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:urldownload]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = mvindex(split(URL, "/"),2)
EVAL-http_content_type = "download"
EVAL-http_method = "GET"
EVAL-site = mvindex(split(URL, "/"),2)
EVAL-status = "200"
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-src = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-src_ip = coalesce(identSrc, MachineIP)
EVAL-src_host = coalesce(identHostName, MachineName)
FIELDALIAS-wg_ep_urldownload_process_path = ParentPath AS app
FIELDALIAS-wg_ep_urldownload_result = ChildCat AS category
FIELDALIAS-wg_ep_urldownload_url = URL AS url
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys

[watchguard:endpoint:alertmalware]
EVAL-action = if(lower(ExecutionStatus) LIKE "%block%", "blocked", if(lower(ExecutionStatus) LIKE "%quarantine%", "deferred", "allowed"))
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-src = coalesce(SourceMachineName, HostName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = case(isnotnull(ItemPath), mvindex(split(mvindex(split(ItemPath, "\\"),-1), "/"),-1), isnotnull(MWPath), mvindex(split(mvindex(split(MWPath, "\\"),-1), "/"),-1), 1==1, "unknown")
EVAL-file_hash = coalesce(ItemHash, MWHash, "unknown")
EVAL-file_path = coalesce(ItemPath, MWPath, "unknown")
EVAL-signature = coalesce(ItemName, MWName, "unknown")
EVAL-severity = "high"
FIELDALIAS-wg_ep_alertmalware_url = UrlList AS url
FIELDALIAS-wg_ep_alertmalware_product_version = Version AS product_version
FIELDALIAS-wg_ep_alertmalware_category = ThreatType AS category
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = (Date|devTime)=

[watchguard:endpoint:alertpup]
EVAL-action = if((lower(ExecutionStatus) LIKE "%allow%"), "allowed", "blocked")
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-file_name = case(isnotnull(ItemPath), mvindex(split(mvindex(split(ItemPath, "\\"),-1), "/"),-1), isnotnull(MWPath), mvindex(split(mvindex(split(MWPath, "\\"),-1), "/"),-1), 1==1, "unknown")
EVAL-file_hash = coalesce(ItemHash, MWHash, "unknown")
EVAL-file_path = coalesce(ItemPath, MWPath, "unknown")
EVAL-signature = coalesce(ItemName, MWNamem, "unknown")
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-category = "pup"
EVAL-severity = "low"
#FIELDALIAS-wg_ep_category = cef_name AS category
FIELDALIAS-wg_ep_url = UrlList AS url
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = (Date|devTime)=

[watchguard:endpoint:alertadvpolicy]
EVAL-action = if(lower(ExecutionStatus) LIKE "%block%", "blocked", if(lower(ExecutionStatus) LIKE "%disinfect%", "blocked", if(lower(ExecutionStatus) LIKE "%delete%", "blocked", "allowed")))
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-src = coalesce(SourceMachineName, HostName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = case(isnotnull(ItemPath), mvindex(split(mvindex(split(ItemPath, "\\"),-1), "/"),-1), isnotnull(MWPath), mvindex(split(mvindex(split(MWPath, "\\"),-1), "/"),-1), 1==1, "unknown")
EVAL-file_hash = coalesce(ItemHash, MWHash, "unknown")
EVAL-file_path = coalesce(ItemPath, MWPath, "unknown")
EVAL-signature = coalesce(ItemName, MWName, "unknown")
EVAL-severity = "low"
EVAL-ids_type = "host"
FIELDALIAS-wg_ep_alertadvpolicy_url = UrlList AS url
FIELDALIAS-wg_ep_alertadvpolicy_product_version = Version AS product_version
FIELDALIAS-wg_ep_alertadvpolicy_category = ThreatType AS category
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = (Date|devTime)=


[watchguard:endpoint:alertexploit]
EVAL-action = if(lower(ExecutionStatus) LIKE "%block%", "blocked", if(lower(ExecutionStatus) LIKE "%disinfect%", "blocked", if(lower(ExecutionStatus) LIKE "%delete%", "blocked", "allowed")))
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-src = coalesce(SourceMachineName, HostName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = case(isnotnull(ItemPath), mvindex(split(mvindex(split(ItemPath, "\\"),-1), "/"),-1), isnotnull(MWPath), mvindex(split(mvindex(split(MWPath, "\\"),-1), "/"),-1), 1==1, "unknown")
EVAL-file_hash = coalesce(ItemHash, MWHash, "unknown")
EVAL-file_path = coalesce(ItemPath, MWPath, "unknown")
EVAL-signature = coalesce(ItemName, MWName, "unknown")
EVAL-severity = "high"
EVAL-ids_type = "host"
FIELDALIAS-wg_ep_alertexploit_url = UrlList AS url
FIELDALIAS-wg_ep_alertexploit_product_version = Version AS product_version
FIELDALIAS-wg_ep_alertexploit_category = ThreatType AS category
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = (Date|devTime)=

[watchguard:endpoint:alertdeepinspection]
EVAL-action = if(lower(ExecutionStatus) LIKE "%block%", "blocked", "allowed")
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = case(isnotnull(ItemPath), mvindex(split(mvindex(split(ItemPath, "\\"),-1), "/"),-1), isnotnull(MWPath), mvindex(split(mvindex(split(MWPath, "\\"),-1), "/"),-1), 1==1, "unknown")
EVAL-file_hash = coalesce(ItemHash, MWHash, "unknown")
EVAL-file_path = coalesce(ItemPath, MWPath, "unknown")
EVAL-signature = coalesce(ItemName, MWName, "unknown")
EVAL-severity = "high"
EVAL-ids_type = "host"
FIELDALIAS-wg_ep_alertdeepinspection_category = ThreatType AS category
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TIME_PREFIX = (Date|devTime)=

[watchguard:endpoint:thalert]
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-severity = lower(Severity)
FIELDALIAS-wg_ep_thalert_url = UrlList AS url
FIELDALIAS-wg_ep_thalert_product_version = Version AS product_version
FIELDALIAS-wg_ep_thalert_category = ThreatType AS category
FIELDALIAS-wg_ep_thalert_signature = THRuleName as signature
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=

[watchguard:endpoint:heuhooks]
EVAL-action = if(lower(ExecutionStatus) LIKE "%block%", "blocked", if(lower(ExecutionStatus) LIKE "%disinfect%", "blocked", if(lower(ExecutionStatus) LIKE "%delete%", "blocked", "allowed")))
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-src = coalesce(SourceMachineName, HostName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
EVAL-file_name = case(isnotnull(ItemPath), mvindex(split(mvindex(split(ItemPath, "\\"),-1), "/"),-1), isnotnull(MWPath), mvindex(split(mvindex(split(MWPath, "\\"),-1), "/"),-1), 1==1, "unknown")
EVAL-file_hash = coalesce(ItemHash, MWHash, "unknown")
EVAL-file_path = coalesce(ItemPath, MWPath, "unknown")
EVAL-signature = coalesce(ItemName, MWName, "unknown")
EVAL-severity = "low"
EVAL-ids_type = "host"
FIELDALIAS-wg_ep_heuhooks_product_version = Version AS product_version
FIELDALIAS-wg_ep_heuhooks_category = ThreatType AS category
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
MAX_DAYS_AGO = 3650
MAX_TIMESTAMP_LOOKAHEAD = 26
NO_BINARY_CHECK = 1
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
SHOULD_LINEMERGE = 0
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=

[watchguard:endpoint:openlsass]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
KV_MODE = none
NO_BINARY_CHECK = true
MAX_TIMESTAMP_LOOKAHEAD = 26
MAX_DAYS_AGO = 3650
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%f
TIME_PREFIX = (Date|devTime)=
EVAL-vendor = "WatchGuard"
EVAL-vendor_product = "WatchGuard EPDR & Panda AD360"
EVAL-dest = coalesce(identHostName, MachineName, identSrc, MachineIP)
EVAL-dest_ip = coalesce(identSrc, MachineIP)
EVAL-dest_host = coalesce(identHostName, MachineName)
EVAL-user = mvindex(split(coalesce(User, usrName, null()), "\\"), -1)
REPORT-wg_ep_headers = wg_ep_headers
REPORT-wg_ep_keys = wg_ep_keys
EVAL-action = if(lower(ExecutionStatus) LIKE "%block%", "blocked", if(lower(ExecutionStatus) LIKE "%disinfect%", "blocked", if(lower(ExecutionStatus) LIKE "%delete%", "blocked", "allowed")))
EVAL-process = lower(ParentPath)
EVAL-process_exec = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-process_name = lower(mvindex(split(mvindex(split(ParentPath, "\\"),-1), "/"),-1))
EVAL-file_name = lower(mvindex(split(mvindex(split(ChildPath, "\\"),-1), "/"),-1))
FIELDALIAS-wg_ep_loadlib_pid = ParentPid as process_id
FIELDALIAS-wg_ep_loadlib_process_hash = ParentHash as process_hash
FIELDALIAS-wg_ep_loadlib_file_hash = ChildHash as file_hash
FIELDALIAS-wg_ep_loadlib_file_path = ChildPath as file_path
FIELDALIAS-wg_ep_loadlib_loaded_file = ChildPath as loaded_file